# USB2to10
## 概要

このアプリケーションは、シリアルポートから受信したバイナリデータを読み取り、10進数に変換してコンソールに表示します。
実際のシリアルポートデバイス、またはテスト用のモックデバイスのいずれかを使用するように設定できます。

## 機能

-   シリアルポートからのデータ受信
-   受信したバイナリ文字列を10進数に変換して表示
-   実際のシリアルポート (`RealSerialPortService`) とモック (`MockSerialPortService`) の切り替え機能
-   モックサービスはランダムな8桁のバイナリ文字列を1秒ごとに生成

## 使い方

1.  **設定:**
    `Program.cs` ファイル内の `useMock` 変数を変更することで、使用するサービスを切り替えることができます。
    ```csharp
    // Program.cs
    static void Main()
    {
        // ↓ ここで切り替え可能（実機 or モック）
        bool useMock = true; // true: モックを使用, false: 実機を使用

        // ... (以下略)
    }
    ```
    -   `useMock = true;` の場合: `MockSerialPortService` が使用され、ランダムなバイナリデータが生成されます。
    -   `useMock = false;` の場合: `RealSerialPortService` が使用されます。この場合、`DetectSerialPort()` メソッドが適切なシリアルポートを検出する必要があります。現状、`DetectSerialPort()` の具体的な実装は省略されているため、実際のハードウェアを使用する際にはこの部分を適切に実装する必要があります。

2.  **実行:**
    アプリケーションをビルドして実行すると、コンソールにデータ受信状況が表示されます。
    -   モックモードの場合: `受信: (ランダムな8桁のバイナリ) → (10進数値)` のように表示されます。
    -   実機モードの場合: 接続されたシリアルポートから受信したデータが表示されます。
    -   無効なデータ（バイナリ文字列でないデータ）を受信した場合は、`無効なデータ: (受信データ)` と表示されます。

3.  **終了:**
    Enterキーを押すとアプリケーションが終了します。

## コード構成

-   **`ISerialPortService.cs`**: シリアルポートサービスのインターフェースを定義します。
    -   `Open()`: ポートを開きます。
    -   `Close()`: ポートを閉じます。
    -   `DataReceived`: データ受信時に発生するイベントです。
-   **`RealSerialPortService.cs`**: `ISerialPortService` を実装し、実際のシリアルポート通信を処理します。
-   **`MockSerialPortService.cs`**: `ISerialPortService` を実装し、テスト用のモックデータを提供します。
-   **`Program.cs`**: アプリケーションのエントリーポイントです。シリアルポートサービスを初期化し、受信データを処理・表示します。

## 注意点

-   `RealSerialPortService` を使用する場合、`DetectSerialPort()` メソッドが正しく実装され、適切なシリアルポート名が返されることを確認してください。
-   `RealSerialPortService` での受信エラーは現在無視されるようになっています。必要に応じてエラーハンドリングを強化してください。
